SELECT * FROM ATTORI;
SELECT * FROM FILM;
SELECT * FROM PROIEZIONI;
SELECT * FROM SALE;
SELECT * FROM RECITA;

-- 1. Quali film sono proiettati nelle varie sale
SELECT SALE.NOME_SALA, FILM.TITOLO
FROM SALE
INNER JOIN PROIEZIONI ON SALE.COD_SALA = PROIEZIONI.COD_SALA
INNER JOIN FILM ON PROIEZIONI.COD_FILM = FILM.COD_FILM;

-- 2. Quali sono gli incassi di un film nelle varie sale
SELECT FILM.TITOLO, SALE.NOME_SALA, SUM(PROIEZIONI.INCASSO) AS INCASSO_TOTALE
FROM FILM
INNER JOIN PROIEZIONI ON FILM.COD_FILM = PROIEZIONI.COD_FILM
INNER JOIN SALE ON PROIEZIONI.COD_SALA = SALE.COD_SALA
GROUP BY FILM.TITOLO, SALE.NOME_SALA;

-- 3. Quali sono gli attori presenti in un film
SELECT FILM.TITOLO, ATTORI.NOME
FROM FILM
INNER JOIN RECITA ON FILM.COD_FILM = RECITA.COD_FILM
INNER JOIN ATTORI ON RECITA.ID_ATT = ATTORI.ID_ATT;

-- 4. Quali sono i generi di film proiettati nelle varie sale
SELECT SALE.NOME_SALA, FILM.GENERE AS NOME_GENERE
FROM SALE
INNER JOIN PROIEZIONI ON SALE.COD_SALA = PROIEZIONI.COD_SALA
INNER JOIN FILM ON PROIEZIONI.COD_FILM = FILM.COD_FILM
GROUP BY SALE.NOME_SALA, FILM.GENERE;

-- 5. A quali film ha preso parte un attore
SELECT ATTORI.NOME, FILM.TITOLO
FROM ATTORI
INNER JOIN RECITA ON ATTORI.ID_ATT = RECITA.ID_ATT
INNER JOIN FILM ON RECITA.COD_FILM = FILM.COD_FILM;

-- 6. A quali generi ha preso parte un attore
SELECT ATTORI.NOME, FILM.GENERE AS NOME_GENERE
FROM ATTORI
INNER JOIN RECITA ON ATTORI.ID_ATT = RECITA.ID_ATT
INNER JOIN FILM ON RECITA.COD_FILM = FILM.COD_FILM;


-- 7. Quanto hanno incassato i vari film in totale a cui ha preso parte un attore
SELECT ATTORI.NOME, FILM.TITOLO, SUM(PROIEZIONI.INCASSO) AS INCASSO_TOTALE
FROM ATTORI
INNER JOIN RECITA ON ATTORI.ID_ATT = RECITA.ID_ATT
INNER JOIN FILM ON RECITA.COD_FILM = FILM.COD_FILM
INNER JOIN PROIEZIONI ON FILM.COD_FILM = PROIEZIONI.COD_FILM
GROUP BY ATTORI.NOME, FILM.TITOLO;

-- 8. Qual è stato l'incasso massimo di un film
SELECT FILM.TITOLO, MAX(PROIEZIONI.INCASSO) AS INCASSO_MASSIMO
FROM FILM
INNER JOIN PROIEZIONI ON FILM.COD_FILM = PROIEZIONI.COD_FILM
GROUP BY FILM.TITOLO;

-- 9. Qual è stato l'incasso medio di un film
SELECT FILM.TITOLO, AVG(PROIEZIONI.INCASSO) AS INCASSO_MEDIO
FROM FILM
INNER JOIN PROIEZIONI ON FILM.COD_FILM = PROIEZIONI.COD_FILM
GROUP BY FILM.TITOLO;

-- 10. Qual è stato l'incasso massimo di un attore
SELECT ATTORI.NOME, MAX(PROIEZIONI.INCASSO) AS INCASSO_MASSIMO
FROM ATTORI
INNER JOIN RECITA ON ATTORI.ID_ATT = RECITA.ID_ATT
INNER JOIN FILM ON RECITA.COD_FILM = FILM.COD_FILM
INNER JOIN PROIEZIONI ON FILM.COD_FILM = PROIEZIONI.COD_FILM
GROUP BY ATTORI.NOME;

-- 11. Qual è stata la media di incasso dei film a cui ha partecipato un attore
SELECT ATTORI.NOME, AVG(PROIEZIONI.INCASSO) AS INCASSO_MEDIO
FROM ATTORI
INNER JOIN RECITA ON ATTORI.ID_ATT = RECITA.ID_ATT
INNER JOIN FILM ON RECITA.COD_FILM = FILM.COD_FILM
INNER JOIN PROIEZIONI ON FILM.COD_FILM = PROIEZIONI.COD_FILM
GROUP BY ATTORI.NOME;

-- 12. Qual è l'incasso medio dei film per sala
SELECT SALE.NOME_SALA, AVG(PROIEZIONI.INCASSO) AS INCASSO_MEDIO
FROM SALE
INNER JOIN PROIEZIONI ON SALE.COD_SALA = PROIEZIONI.COD_SALA
GROUP BY SALE.NOME_SALA;

-- 13. Quali sono gli incassi medi dei film per mese nelle varie sale
SELECT SALE.NOME_SALA, TO_CHAR(PROIEZIONI.DATA_PROIEZIONE, 'MM') AS MESE, AVG(PROIEZIONI.INCASSO) AS INCASSO_MEDIO
FROM SALE
INNER JOIN PROIEZIONI ON SALE.COD_SALA = PROIEZIONI.COD_SALA
GROUP BY SALE.NOME_SALA, TO_CHAR(PROIEZIONI.DATA_PROIEZIONE, 'MM');


SELECT table_name
FROM all_tables
WHERE table_name IN ('SALE', 'PROIEZIONI', 'FILM', 'GENERI_FILM', 'GENERI');

